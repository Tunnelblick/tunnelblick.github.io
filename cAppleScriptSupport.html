<!doctype html>
<html>
<head>
	<meta charset="UTF-8" lang="en">
	<meta name="description" content="AppleScript Support - Tunnelblick | Free open source OpenVPN VPN client server software GUI for Mac OS X.. Includes OpenVPN, OpenSSL, easy-rsa, and drivers.">
	<meta name="referrer" content="never">
	<title>AppleScript Support - Tunnelblick | Free open source OpenVPN VPN client server software GUI for Mac OS X.</title>
	<link rel="stylesheet" type="text/css"  href="/common/style.v5.css">
	<link rel="icon"       type="image/png" href="/common/favicon.v1.png">
</head>

<body>
<center><table><tr><td><font color="red">THIS IS A COPY OF A PAGE AT <a href="https://tunnelblick.net">THE OFFICIAL TUNNELBLICK WEBSITE</a> AS OF 2018-01-08 03:08:55 UTC</font></td></tr></table></center>

<div class="heading">
	<table>
		<tr>
			<td><a href="/"><img src="/common/tb-icon-64x64.v1.png" alt="tunnelblick icon" width="64" height="64"></a></td>
			<td class="heading1">Tunnelblick</td>
			<td class="heading2">free software for OpenVPN on OS&nbsp;X and macOS</td>
			<td class="heading3">
                <a href="/cLocalizeTranslate.html">We need translators for several languages&hellip;</a><br>
            </td>
		</tr>
	</table>
</div>


<div class="topnav">
<table class="topnav"><tbody><tr>
	<td class="topnav-normal"   ><a href="/index.html"      class="topnav">Home</a></td>
	<td class="topnav-normal"   ><a href="/downloads.html"  class="topnav">Downloads</a></td>
	<td class="topnav-normal"   ><a href="/support.html"    class="topnav">Support</a></td>
	<td class="topnav-highlight"><a href="/documents.html"  class="topnav">Documents</a></td>
	<td class="topnav-normal"   ><a href="/issues.html"     class="topnav">Issues</a></td>
	<td class="topnav-normal"   ><a href="/source.html"     class="topnav">Source</a></td>
	<td class="topnav-normal"   ><a href="/contribute.html" class="topnav">Contribute</a></td>
	<td class="topnav-normal"   ><a href="/reachus.html"    class="topnav">Contact</a></td>
	<td class="topnav-padding"  ></td>
</tbody></table>
</div>



<div class="content">
<div class="content-cAppleScriptSupport">
<table class="documents">
  <tr>
    <td class="documents-left">



<p><strong>Highlighted Articles</strong><br>
&nbsp;&nbsp;<a href="/cInstall.html">Installing Tunnelblick</a><br>
&nbsp;&nbsp;<a href="/cUninstall.html">Uninstalling Tunnelblick</a><br>
&nbsp;&nbsp;<a href="/cConfigT.html">Setting up Configurations</a><br>
&nbsp;&nbsp;<a href="/czUsing.html">Using Tunnelblick</a><br>
&nbsp;&nbsp;<a href="/cGettingVPNService.html">Getting VPN Service</a><br>
&nbsp;&nbsp;<a href="/cCommonProblems.html">Common Problems</a><br>
&nbsp;&nbsp;<a href="/cConfigO.html">Configuring OpenVPN</a><br>
&nbsp;&nbsp;<a href="/cRlsNotes.html">Release Notes</a><br>
&nbsp;&nbsp;<a href="/cThanks.html">Thanks</a><br>
&nbsp;&nbsp;<a href="/cFAQ.html">FAQ</a></p>

<p><strong><a href="https://groups.google.com/forum/#&#33;forum/tunnelblick-discuss">Discussion Group</a></strong><br>
&nbsp;&nbsp;<a href="/cBeforeYouPost.html">Read Before You Post</a></p>



    </td>
    <td class="documents-right">
    


<h1 id="applescript-support">AppleScript Support</h1>
<p class=toc>On This Page<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#controlling-tunnelblick-with-applescript">Controlling Tunnelblick with AppleScript</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#controlling-tunnelblick-from-the-command-line">Controlling Tunnelblick from the Command Line</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#applescript-dictionary">AppleScript Dictionary</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#examples">Examples</a><br>
</p> 
<hr>
<h2 id="controlling-tunnelblick-with-applescript">Controlling Tunnelblick with AppleScript</h2>
<p>This document is about making Tunnelblick do things via scripting. Tunnelblick itself also uses scripts; see <a href="cUsingScripts.html">Using Scripts</a>.</p>
<p>AppleScripts may connect, disconnect, or list Tunnelblick configurations.</p>
<p>Please note that the verbs only <em>initiate</em> actions. The &quot;connect&quot; verb, for example, is the equivalent of clicking the &quot;Connect&quot; button. It returns immediately after starting an attempt to connect using a particular configuration and does not indicate the connection has been accomplished successfully.</p>
<p>For an example of using Tunnelblick's AppleScript support to solve a particular problem, see <a href="https://groups.google.com/d/topic/tunnelblick-discuss/1MDrN6__mdA/discussion">this discussion</a>.</p>
<hr>
<h2 id="controlling-tunnelblick-from-the-command-line">Controlling Tunnelblick from the Command Line</h2>
<p>You can invoke AppleScript from the command line to control Tunnelblick. You can connect, disconnect, and list configurations.</p>
<p>One way is to store the AppleScript in a file and then invoke it with</p>
<p><span class="monospaced">   osascript</span> <em>name-of-file</em></p>
<p>Another way is to include the AppleScript commands in the command line with, for example,</p>
<p><span class="monospaced">   osascript -e &quot;tell application \&quot;/Applications/Tunnelblick.app\&quot;&quot; -e &quot;connect </span>\&quot;<em>configuration-name</em>\&quot;&quot;<span class="monospaced"> -e &quot;end tell&quot;</span></p>
<p>replacing <em>configuration-name</em> with the name of your configuration.</p>
<hr>
<h2 id="applescript-dictionary">AppleScript Dictionary</h2>
<p><strong>application</strong> <em>n</em> :</p>
<p>contains <em>configurations</em>.</p>
<p><strong>configuration</strong> <em>n</em> : A VPN configuration.</p>
<p>contained by <strong>application</strong>.</p>
<p>properties</p>
<p><strong>name</strong> (text, r/o) : Name of the configuration.</p>
<p><strong>state</strong> (text, r/o) : State of the configuration.<br>'EXITING' means disconnecting or disconnected.<br>'CONNECTED' means connected.<br>Other values show progress towards a connection.</p>
<p><strong>autoconnect</strong> (text, r/o):<br>'LAUNCH' means the configuration will be connected automatically when Tunnelblick launches.<br>'START' means the configuration will be connected automatically when the computer starts.<br>'NO' means the configuration will not be connected automatically.</p>
<p><strong>bytesIn</strong> (text, r/o) :<br>The number of bytes that have come in through the connection since Tunnelblick was launched. (For client configurations only. This will return &quot;0&quot; for configurations that are functioning as a server.)</p>
<p><strong>bytesOut</strong> (text, r/o) :<br>The number of bytes that have gone out through the connection since Tunnelblick was launched. (For client configurations only. This will return &quot;0&quot; for configurations that are functioning as a server.)</p>
<p><strong>connect</strong> <em>v</em> : Connect a VPN configuration.</p>
<p><strong>connect</strong> text : Name of configuration to connect.<br>-&gt; boolean : Returns true if a connection is being attempted, false if the configuration is already connected.</p>
<p><strong>disconnect</strong> <em>v</em> : Disconnect a VPN configuration.<br>disconnect text : Name of configuration to disconnect.<br>-&gt; boolean : Returns true if a disconnection is being attempted, false if the configuration is already disconnected.</p>
<p><strong>connect all</strong> <em>v</em> : Connect all unconnected VPN configurations.<br>-&gt; integer : Returns the number of configurations for which a connection is being attempted.</p>
<p><strong>disconnect all</strong> <em>v</em> : Disconnect all connected VPN configurations.<br>-&gt; integer : Returns the number of configurations for which a disconnection is being attempted.</p>
<p><strong>disconnect all except when computer starts</strong> <em>v</em> : Disconnect all connected VPN configurations except 'when computer starts' configurations.<br>-&gt; integer : Returns the number of configurations for which a disconnection is being attempted.</p>
<hr>
<h2 id="examples">Examples</h2>
<p>tell application &quot;Tunnelblick&quot;</p>
<p>get configurations<br />
 -&gt; {configuration &quot;Work&quot;, configuration &quot;Work-Development&quot;, configuration &quot;Home&quot;, configuration &quot;Test&quot;}</p>
<p>disconnect all<br />
 -&gt; 0</p>
<p>connect &quot;Work-Development&quot;<br />
 -&gt; true</p>
<p>disconnect (get name of second configuration)<br />
 get name of configuration 2<br />
 -&gt; &quot;Work-Development&quot;<br />
 disconnect &quot;Work-Development&quot;<br />
 -&gt; true</p>
<p>connect (get name of first configuration where state = &quot;EXITING&quot;)<br />
 get name of configuration 1 whose state = &quot;EXITING&quot;<br />
 -&gt; &quot;Work&quot;<br />
 connect &quot;Work&quot;<br />
 -&gt; true</p>
<p>disconnect all except when computer starts<br />
 -&gt; 1</p>
<p>get state of second configuration<br />
 -&gt; &quot;EXITING&quot;</p>
<p>get state of first configuration where name = &quot;Work&quot;<br />
 -&gt; &quot;EXITING&quot;</p>
<p>get name of configurations<br />
 -&gt; {&quot;Work&quot;, &quot;Work-Development&quot;, &quot;Home&quot;, &quot;Test&quot;}</p>
<p>get state of configurations<br />
 -&gt; {&quot;EXITING&quot;, &quot;EXITING&quot;, &quot;EXITING&quot;, &quot;EXITING&quot;}</p>
<p>get autoconnect of configurations<br />
 -&gt; {&quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;, &quot;NO&quot;}</p>
<p>end tell</p>



   </td>
  </tr>
</table>
</div>
</div>



<div class="bottom-translation">
  <span title="view in German or another language using Google Translate">               <a lang="de"      class="bottom-translation" href="https://translate.google.com/translate?hl=de&amp;sl=en&amp;tl=de&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;Deutsch&nbsp;&nbsp;         </a></span>
  <span title="view in French or another language using Google Translate">               <a lang="fr"      class="bottom-translation" href="https://translate.google.com/translate?hl=fr&amp;sl=en&amp;tl=fr&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;Français&nbsp;&nbsp;        </a></span>
  <span title="view in Chinese (simplified) or another language using Google Translate"> <a lang="zh-Hans" class="bottom-translation" href="https://translate.google.com/translate?hl=zh-CN&amp;sl=en&amp;tl=zh-CN&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;中文(简体)&nbsp;&nbsp; </a></span>
  <span title="view in Russian or another language using Google Translate">              <a lang="ru"      class="bottom-translation" href="https://translate.google.com/translate?hl=ru&amp;sl=en&amp;tl=ru&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;Русский&nbsp;&nbsp;         </a></span>
  <span title="view in Spanish or another language using Google Translate">              <a lang="es"      class="bottom-translation" href="https://translate.google.com/translate?hl=es&amp;sl=en&amp;tl=es&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;Español&nbsp;&nbsp;         </a></span>
  <span title="view in Japanese or another language using Google Translate">             <a lang="ja"      class="bottom-translation" href="https://translate.google.com/translate?hl=ja&amp;sl=en&amp;tl=ja&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;日本語&nbsp;&nbsp;           </a></span>
  <span title="view in Italian or another language using Google Translate">              <a                class="bottom-translation" href="https://translate.google.com/translate?hl=it&amp;sl=en&amp;tl=it&amp;u=https%3A%2F%2Fwww.tunnelblick.net%2FcAppleScriptSupport.html&amp;sandbox=1">&nbsp;&nbsp;&hellip;&nbsp;&nbsp;        </a></span>
</div>
<div class="bottom-copyright">
  Copyright &copy; 2015-2017 by The Tunnelblick Project.&nbsp;&nbsp;
</div>
</body>
</html>
